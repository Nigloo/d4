<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D4 Test</title>
        <style>
            .axis path,
            .axis line {
                fill: none;
                stroke: black;
                shape-rendering: crispEdges;
            }

            .axis text {
                font-family: sans-serif;
                font-size: 11px;
            }
            
            .whisker_limit {
                visibility: hidden;
            }
        </style>
        <script type="text/javascript" src="d3.v3.js"></script>
        <script type="text/javascript" src="d4.js"></script>
        <script type="text/javascript">
            
            "use strict";
            
            
/////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////
            /*
            d4.graphic()
            .hack({ bar_padding:0, drawBackground:false})
            .coord(d4.rect({x:'x', y:null,
                            subSys:d4.rect({x:'sub_cat', y:'y'})}))
            .time({t:'data:year'})
            .bar({  x:'data:age',
                    sub_cat:function(d){return d.sex.toString();},
                    y:d4.interval(0, 'data:people'),
                    fill:function(d){return d.sex == 1 ? '#1f77b4' : '#e377c2';},
                    label:'data:people'})
            .data({data:d4.loadFromFile({file:'data/population.csv'})})
            .plot({selector:"#graph1", width:960, height:500, margin:20, margin_left:80});
            
/////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////
            
            var marriage_status = ['Unknown','Married','Married, Spouse Absent','Separated','Divorced','Widowed','Single'];
            function marriageStatus(d) {
                return marriage_status[d.marst];
            }
            
            d4.graphic()
            .hack({ bar_padding:0, drawBackground:false})
            .coord(d4.rect({x:'x', y:null,
                            subSys:d4.rect({x:'sub_cat', y:'y'})}))
            .time({ year:'data:year',
                    age:'data:age'})
            .bar({  x:marriageStatus,
                    sub_cat:function(d){return d.sex.toString();},
                    y:d4.interval(0, 'data:people'),
                    fill:function(d){return d.sex == 1 ? '#1f77b4' : '#e377c2';},
                    label:'data:people'})
            .data({data:d4.loadFromFile({file:'data/census_marriage.csv'})})
            .plot({selector:"#graph2", width:960, height:500, margin:20, margin_left:80});
            
/////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////
            */
            var sex_string = ['', 'Male', 'Female'];
            function sex(d) {
                return sex_string[d.sex];
            }
            
            d4.graphic()
            .hack({ bar_padding:0, drawBackground:false})
            .coord(d4.rect({y:null,
                            subSys:d4.polar({radius:null})}))
            .time({ year:'data:year'})
            .bar({  x:sex,
                    theta:d4.interval.stack('data:proportion'),
                    fill:'data:marst',
                    label:'data:marst'})
            .data({data:d4.loadFromFile({file:'data/census_marriage.csv'})})
            .dataView({name:'default_data', func:d4.groupBy({year:'data:year', sex:'data:sex'}).proportion({marst:'data:marst', weight:'data:people'})})
            .plot({selector:"#graph3", width:960, height:500, margin:20, margin_left:80});
            
/////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////
          
          
        </script>
    </head>
    <body>
        <div id="graph1">
            <h2>United States Population Pyramid</h2>
        </div>
        
        <div id="graph2">
            <h2>United States Census Marriage</h2>
        </div>
        <div id="graph3">
            <h2>United States Census Marriage Pie</h2>
        </div>
    </body>
</html>   
